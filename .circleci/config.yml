version: 2.1

orbs:
  heroku: circleci/heroku@2.0.0

jobs:
  heroku/deploy-via-git:
    machine: # executor type
      image: ubuntu-2004:202010-01
    steps:
      - run:
          command: |-
            #!/bin/bash
            
            if ! command -v heroku &> /dev/null; then
              curl https://cli-assets.heroku.com/install.sh | sh
            else
              echo "Heroku is already installed. No operation was performed."
            fi
          name: Install Heroku CLI (If not installed)

      - run:
          name: Deploy to Heroku
          command: |
            git push heroku main
workflows:
  version: 2
  heroku_deploy:
    jobs:
      - heroku/deploy-via-git
